// SPDX-FileCopyrightText: 2024 Mass Labs
//
// SPDX-License-Identifier: MIT

syntax = "proto3";

package market.mass;

import "error.proto";

// Initiates the challenge/response protocol.
message AuthenticateRequest {
  bytes public_key = 1; // of their keyCard
}

// Returns an error if the public key is not an enrolled KeyCard.
// or a challenge to be signed by the KeyCard.
message AuthenticateResponse {
  oneof response {
    Error error = 1;
    bytes challenge = 2;
  }
}

// Completes authentication by supplying the signature over the challenge.
message ChallengeSolvedRequest {
  bytes signature = 1;
}

// No error means the user is authenticated.
message ChallengeSolvedResponse {
  optional Error error = 1;
}
